#!/bin/sh
#
# A wrapper script to decide how to invoke gnome-session
GNOME_SESSION_VER=`dpkg-query --showformat='${Version}' --show gnome-session`

SESSION="gnome-session"
ARGS=""

# STDERR will go somewhere useful at this point, right?
echo "**** Athena session wrapper (/usr/bin/athena-session)" >&2

# Support for --session was added in gnome-session 2.32.1-0ubuntu2
# according to the changelog
if dpkg --compare-versions "$GNOME_SESSION_VER" ge '2.32.1-0ubuntu2~'; then
  ARGS="--session=classic-gnome"
  echo "  Unity detected, invoking classic GNOME session." >&2
fi

exec "$SESSION" "$ARGS" "$@"
